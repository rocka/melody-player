!function(t){var e={};function i(n){if(e[n])return e[n].exports;var s=e[n]={i:n,l:!1,exports:{}};return t[n].call(s.exports,s,s.exports,i),s.l=!0,s.exports}i.m=t,i.c=e,i.d=function(t,e,n){i.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},i.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=6)}([function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var i=function(t,e){var i=t[1]||"",n=t[3];if(!n)return i;if(e&&"function"==typeof btoa){var s=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(n),r=n.sources.map(function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"});return[i].concat(r).concat([s]).join("\n")}return[i].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+i+"}":i}).join("")},e.i=function(t,i){"string"==typeof t&&(t=[[null,t,""]]);for(var n,s={},r=0;r<this.length;r++)"number"==typeof(n=this[r][0])&&(s[n]=!0);for(r=0;r<t.length;r++){var o=t[r];"number"==typeof o[0]&&s[o[0]]||(i&&!o[2]?o[2]=i:i&&(o[2]="("+o[2]+") and ("+i+")"),e.push(o))}},e}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,s=function(){function t(t,e){for(var i,n=0;n<e.length;n++)(i=e[n]).enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(2),o=(n=r)&&n.__esModule?n:{default:n};var a=function(){function t(){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.info={},this.lyrics=[]}return s(t,[{key:"offset",value:function(t){this.lyrics.forEach(function(e){e.timestamp+=t,0>e.timestamp&&(e.timestamp=0)})}},{key:"clone",value:function(){function t(t){var e={};for(var i in t)e[i]=t[i];return e}var e=new this.constructor;return e.info=t(this.info),e.lyrics=this.lyrics.reduce(function(e,i){return e.push(t(i)),e},[]),e}},{key:"toString",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};e.combine=!("combine"in e)||e.combine,e.lineFormat="lineFormat"in e?e.lineFormat:"\r\n",e.sort=!("sort"in e)||e.sort;var i=[],n={},s=[];for(var r in this.info)i.push("["+r+":"+this.info[r]+"]");if(e.combine){for(var o in this.lyrics.forEach(function(t){t.content in n?n[t.content].push(t.timestamp):n[t.content]=[t.timestamp]}),n)e.sort&&n[o].sort(),s.push({timestamps:n[o],content:o});e.sort&&s.sort(function(t,e){return t.timestamps[0]-e.timestamps[0]}),s.forEach(function(e){i.push("["+e.timestamps.map(function(e){return t.timestampToString(e)}).join("][")+"]"+(e.content||""))})}else this.lyrics.forEach(function(e){i.push("["+t.timestampToString(e.timestamp)+"]"+(e.content||""))});return i.join(e.lineFormat)}}],[{key:"parse",value:function(t){var e=[],i={};t.split(/\r\n|[\n\r]/g).map(function(t){return new o.default(t)}).forEach(function(t){switch(t.type){case o.default.TYPE.INFO:i[t.key]=t.value;break;case o.default.TYPE.TIME:t.timestamps.forEach(function(i){e.push({timestamp:i,content:t.content})})}});var n=new this;return n.lyrics=e,n.info=i,n}},{key:"padZero",value:function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:2;t.toString().split(".")[0].length<e;)t="0"+t;return t}},{key:"timestampToString",value:function(t){return this.padZero(parseInt(t/60))+":"+this.padZero((t%60).toFixed(2))}}]),t}();e.default=a},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){return function(t,e){if(Array.isArray(t))return t;if(Symbol.iterator in Object(t))return function(t,e){var i,n=[],s=!0,r=!1;try{for(var o,a=t[Symbol.iterator]();!(s=(o=a.next()).done)&&(n.push(o.value),!e||n.length!==e);s=!0);}catch(t){r=!0,i=t}finally{try{!s&&a.return&&a.return()}finally{if(r)throw i}}return n}(t,e);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(){function t(t,e){for(var i,n=0;n<e.length;n++)(i=e[n]).enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}();var r=function(){function t(e){(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.type=t.TYPE.INVALID;try{var i=t.parseTags(e),s=n(i,2),r=s[0],o=s[1];t.TIME_REGEXP.test(r[0])?this.parseAsTime(r,o):t.INFO_REGEXP.test(r[0])?this.parseAsInfo(r[0]):this.type=t.TYPE.INVALID}catch(e){this.type=t.TYPE.INVALID}}return s(t,null,[{key:"parseTags",value:function(e){e=e.trim();var i=t.TAGS_REGEXP.exec(e)[0],n=e.substr(i.length);return[i.slice(1,-1).split(/\]\s*\[/),n]}}]),s(t,[{key:"parseAsTime",value:function(e,i){var n=[];e.forEach(function(e){var i=t.TIME_REGEXP.exec(e),s=parseFloat(i[1]),r=parseFloat(i[2].replace(/\s+/g,"").replace(":","."));n.push(60*s+r)}),this.timestamps=n,this.content=i.trim(),this.type=t.TYPE.TIME}},{key:"parseAsInfo",value:function(e){var i=t.INFO_REGEXP.exec(e);this.key=i[1].trim(),this.value=i[2].trim(),this.type=t.TYPE.INFO}}]),t}();r.TAGS_REGEXP=/^(\[.+\])+/,r.INFO_REGEXP=/^\s*(\w+)\s*:(.*)$/,r.TIME_REGEXP=/^\s*(\d+)\s*:\s*(\d+(\s*[\.:]\s*\d+)?)\s*$/,r.TYPE={INVALID:0,INFO:1,TIME:2},e.default=r},function(t,e,i){var n=i(8);(t.exports=i(0)(!1)).push([t.i,"@font-face{font-family:MelodyPlayerIcons;font-style:normal;font-weight:400;src:url("+n(i(7))+') format("woff2")}',""])},function(t,e,i){(t.exports=i(0)(!1)).push([t.i,'main{display:block;font-family:sans-serif;margin:8px;padding:8px;color:#abb2bf;background-color:#282c34;box-shadow:0 2px 10px rgba(0,0,0,.6)}main .display{position:relative;font-size:14px;height:0;overflow:hidden;transition:height .5s}main .display .lyric{transform:translateY(0);transition:transform .5s cubic-bezier(.25,.46,.45,.94)}main .display .lyric .line{opacity:.4;margin:16px 0;white-space:pre-wrap;text-align:center;transition:color .5s,opacity .5s}main .display .lyric .line.active{color:#fff;opacity:1;text-shadow:0 0 .3px currentColor}main .display .lyric.mask{position:relative;top:calc(50% - 3em)}main .display.active{height:150px}main .display .shadow,main .display:before{content:" ";position:absolute;display:block;width:100%;height:45px;z-index:1}main .display:before{top:0;background-image:linear-gradient(#282c34,transparent)}main .display:after{content:" ";position:absolute;display:block;width:100%;height:45px;z-index:1;bottom:0;background-image:linear-gradient(transparent,#282c34)}main .control{display:flex;align-items:center}main .control button{color:#abb2bf;font:20px MelodyPlayerIcons;display:inline-block;box-sizing:content-box;width:32px;height:32px;border-radius:16px;border:none;margin:0;padding:0;user-select:none;outline:none;cursor:pointer;background-color:transparent;transition:background-color .5s,transform .5s;-webkit-tap-highlight-color:transparent}main .control button:hover{transition:background-color .2s,transform .5s;background-color:hsla(0,0%,100%,.15)}main .control button:active{background-color:hsla(0,0%,100%,.4)}main .control button.flip{transform:rotate(180deg)}main .control button::-moz-focus-inner{border:0}main .control .porgress{cursor:pointer;position:relative;margin-left:8px;flex-grow:1;height:12px;color:#61aeee;background-color:rgba(0,0,0,.6)}main .control .porgress div{width:0;height:inherit;position:absolute;transition:width 1s linear}main .control .porgress div.peek{transition:width .2s}main .control .porgress .load{background-color:hsla(0,0%,100%,.3)}main .control .porgress .play{background-color:currentColor}main .control .porgress .play:after{content:" ";cursor:pointer;color:#fff;position:absolute;box-sizing:content-box;width:2px;height:inherit;right:0;top:0;border:0 solid currentColor;box-shadow:0 0 0 transparent;background-color:currentColor;transition:border .2s,top .2s,right .2s}main .control .porgress:hover .play:after{border-width:6px 3px;box-shadow:0 0 4px rgba(0,0,0,.6);top:-6px;right:-3px}main .control .timer{font-size:14px;margin-left:8px}main .control .control-right{margin-left:8px}main[single] .control-left button:first-child,main[single] .control-left button:last-child{display:none}',""])},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Runner=e.Lrc=e.LineParser=void 0;var n=o(i(2)),s=o(i(1)),r=o(i(9));function o(t){return t&&t.__esModule?t:{default:t}}e.LineParser=n.default,e.Lrc=s.default,e.Runner=r.default},function(t,e,i){"use strict";i.r(e);var n=i(5);function s(t,e,...i){const n=document.createElement(t);return e&&Object.entries(e).forEach(([t,e])=>{if("ref"!==t)switch(typeof e){case"string":n.setAttribute(t,e);break;case"function":const i=t.replace(/^on/,"").toLowerCase();n.addEventListener(i,e)}else e(n)}),i.map(t=>{"string"==typeof t?n.appendChild(document.createTextNode(t)):n.appendChild(t)}),n}var r=i(4),o=i.n(r),a=i(3),l=i.n(a);class c extends HTMLElement{static get TagName(){return"melody-player"}static get LoopMode(){return{Once:0,Single:1,List:2,Shuffle:3,0:"once",1:"single",2:"list",3:"shuffle"}}static get LyricStatus(){return{Loading:0,Loaded:1,Failed:2,None:3,0:"loading",1:"loaded",2:"failed",3:"none"}}static get LogTag(){return"[MelodyPlayer]"}static log(...t){console.log(c.LogTag,...t)}static err(...t){console.error(c.LogTag,...t)}static percent(t){if("number"!=typeof t)throw new Error("percent must be number");return`${(100*t).toFixed(2)}%`}static time(t){if("number"!=typeof t)throw new Error("time must be number");const e=new Date(1e3*t),i=e.getUTCMinutes()+60*e.getUTCHours(),n=e.getUTCSeconds();return[i,9<n?n:`0${n}`].join(":")}static hide(t,e=!0){t.style.display=e?"none":""}get singleMode(){return this._singleMode}set singleMode(t){t!==this._singleMode&&(!0===t?this.hostElem.setAttribute("single",""):this.hostElem.removeAttribute("single"),this._singleMode=t)}get playing(){return this._playing}set playing(t){if(t!==this._playing){this._playing=t;const e=this.btnPlay;e.textContent=e.dataset[t?"pause":"play"];try{this.syncProgress()}catch(t){}}}get playIndex(){return this._playIndex}set playIndex(t){if(t!==this._playIndex){this._playIndex=t;const e=this.audios[t];Number.isNaN(e.duration)?e.addEventListener("loadedmetadata",()=>{this.timerTotal.textContent=c.time(e.duration)}):this.timerTotal.textContent=c.time(e.duration),this.syncProgress(),this.fetchLyric().then(t=>t?this.renderLyric():null)}}get lyricStatus(){return this._lyricStatus}set lyricStatus(t){t!==this._lyricStatus&&(this._lyricStatus=t,[this.lyricMaskLoading,this.containerLyric,this.lyricMaskFailed,this.lyricMaskNone].forEach((e,i)=>c.hide(e,t!==i)))}get lyricIndex(){return this._lyricIndex}set lyricIndex(t){t!==this._lyricIndex&&(window.requestAnimationFrame(((t,e)=>{const i=this.lyrics[t];i&&i.classList.remove("active");const n=this.lyrics[e];n.classList.add("active");let s=75-n.clientHeight/2-n.offsetTop-16;this.containerLyric.style.transform=`translateY(${s}px)`}).bind(this,this._lyricIndex,t)),this._lyricIndex=t)}get loopMode(){return this._loopMode}set loopMode(t){if(t!==this._loopMode){this._loopMode=t;const e=this.btnLoop;e.textContent=e.dataset[c.LoopMode[t]]}}get displayVisible(){return this._displayVisible}set displayVisible(t){t!==this._displayVisible&&(!0===t?(this.btnLyric.classList.add("flip"),this.containerDisplay.classList.add("active")):(this.btnLyric.classList.remove("flip"),this.containerDisplay.classList.remove("active")),this._displayVisible=t)}get au(){return this.audios[this._playIndex]}registerAudio(t){this.audios.push(t);const e={detail:{audio:t}};t.addEventListener("play",()=>{this.playing=!0,this.handleAudioPlaying(),this.dispatchEvent(new CustomEvent("play",e))}),t.addEventListener("pause",()=>{this.playing=!1,this.dispatchEvent(new CustomEvent("pause",e))}),t.addEventListener("ended",()=>{this.handleAudioEnd(),this.dispatchEvent(new CustomEvent("audioend",e))})}init(){this.playing=!1,this.loopMode=c.LoopMode.Once,this.displayVisible=!1;const{length:t}=this.audios;0<t&&(this.playIndex=0,this.singleMode=1===t)}updateProgress(){const{buffered:t,currentTime:e,duration:i}=this.au;let n=0;0!==t.length&&(n=t.end(t.length-1)/i),window.requestAnimationFrame(()=>{this.timerPlay.textContent=c.time(e),this.progressPlay.style.width=c.percent(e/i),this.progressLoad.style.width=c.percent(n)})}syncProgress(){function t(t,e=.2){t.classList.add("peek"),setTimeout(()=>t.classList.remove("peek"),1e3*e)}t(this.progressPlay),t(this.progressLoad),this.updateProgress()}clearLyric(){const t=this.containerLyric;for(let e=t.firstChild;e;)t.removeChild(e),e=t.firstChild}fetchLyric(){this.lyricStatus=0;const t=this.audios[this._playIndex],e={lrc:t.dataset.lrc,subLrc:t.dataset.subLrc},i=Object.entries(e).filter(t=>t[1]).map(([e,i])=>fetch(i).then(t=>{if(200===t.status)return t.text();throw t}).then(i=>{try{t[e]=Object.assign({status:1},n.Lrc.parse(i))}catch(i){c.err("parse lrc",i),t[e]={status:2,lyrics:[]}}}).catch(i=>{c.err("fetch lyric",i),t[e]={status:2,lyrics:[]}}));return Promise.all(i).then(()=>t===this.au)}renderLyric(){const t=this.audios[this._playIndex];if(3===t.lrc.status&&3===t.subLrc.status)return void(this.lyricStatus=3);if(1!==t.lrc.status&&1!==t.subLrc.status)return void(this.lyricStatus=2);this.lyricStatus=1;const e=(t,e)=>t.timestamp-e.timestamp,i=t.lrc.lyrics.sort(e),n=t.subLrc.lyrics.sort(e),r=[{timestamp:0,content:""}],o=[];for(let t=0,e=0;t<i.length||e<n.length;){const s=i[t],o=n[e];s&&o&&s.timestamp===o.timestamp?(r.push({timestamp:s.timestamp,content:`${s.content}\n${o.content}`}),t++,e++):!s&&o||s&&o&&s.timestamp>o.timestamp?(r.push({timestamp:o.timestamp,content:o.content}),e++):(!o&&s||s&&o&&o.timestamp>s.timestamp)&&(r.push({timestamp:s.timestamp,content:s.content}),t++)}const a=document.createDocumentFragment();for(const t of r){const e=s("p",{class:"line","data-timestamp":t.timestamp},t.content);e.timestamp=t.timestamp,a.appendChild(e),o.push(e)}this.lyrics=o,this.clearLyric(),this.containerLyric.appendChild(a),this.nextLyricIndex()}nextLyricIndex(){if(1!==this._lyricStatus)return this.lyricIndex=0;const{currentTime:t}=this.au;let e=this._lyricIndex||0;const i=this.lyrics[this._lyricIndex];if(i){t<(i.timestamp||+i.dataset.timestamp)&&(e=0)}for(let i=e;i<this.lyrics.length;i++){const e=this.lyrics[i];if((e.timestamp||+e.dataset.timestamp)>t)return this.lyricIndex=i?i-1:0}return this.lyricIndex=this.lyrics.length-1}handleAudioPlaying(){var t=Math.floor;const e=this.au.currentTime;e<this._currentSecond&&(this.syncProgress(),this._currentSecond=t(e)),1<e-this._currentSecond&&(this.updateProgress(),this._currentSecond=t(e)),1===this._lyricStatus&&this._displayVisible&&this.nextLyricIndex(),this._playing&&setTimeout(()=>this.handleAudioPlaying(),166)}_play(){return this.au.play()}_pause(t=!0){this.au.pause(),0===t&&(this.au.currentTime=0)}handlePlayOrPause(){this._playing?this._pause():this._play()}nextPlayIndex(t=1,e=!1){const i=this.loopMode,n=this.audios.length;let s=this._playIndex;!0===e||0===i||2===i?s=n+s+t:3===i&&(s=Math.floor(Math.random()*n)),this.playIndex=s%n}handleNext(t=1){this._pause(0),this.nextPlayIndex(t,1===this._loopMode),this._play()}handleAudioEnd(){this._pause(0),this.nextLyricIndex(),this.nextPlayIndex(),0===this._loopMode&&0===this._playIndex?(this.playing=!1,this.dispatchEvent(new CustomEvent("playend"))):this._play()}handleLoopMode(){this._singleMode?(this.loopMode=1===this._loopMode?0:1,this.audios[0].loop=1===this._loopMode):this.loopMode=(this.loopMode+1)%4}handleProgressSeek(t){const e=this.progressFull.getBoundingClientRect(),i=(t.clientX-e.x)/e.width*this.au.duration;this.au.currentTime=i,this.syncProgress(),this._displayVisible&&this.nextLyricIndex(),this._currentSecond=Math.floor(i)}handleToggleDisplay(){this.displayVisible=!this._displayVisible}render(){const t=this.attachShadow({mode:"open"}),e=s("style",null,o.a.toString());this.hostElem=s("main",null,s("div",{ref:t=>this.containerDisplay=t,class:"display"},s("div",{ref:t=>this.lyricMaskLoading=t,class:"lyric mask"},s("p",{class:"line"},"歌词加载中\nLoading Lyric\n歌詞を読み込む")),s("div",{ref:t=>this.lyricMaskFailed=t,class:"lyric mask"},s("p",{class:"line"},"歌词加载失败\nFailed to Load Lyric\n歌詞を読み込めません")),s("div",{ref:t=>this.lyricMaskNone=t,class:"lyric mask"},s("p",{class:"line"},"暂无歌词\nNo Lyric\n歌詞なし")),s("div",{ref:t=>this.containerLyric=t,class:"lyric"})),s("div",{class:"control"},s("div",{class:"control-left"},s("button",{ref:t=>this.btnPrev=t,onClick:()=>this.handleNext(-1)},"skip_previous"),s("button",{ref:t=>this.btnPlay=t,onClick:t=>this.handlePlayOrPause(t),"data-play":"play_arrow","data-pause":"pause"},"stop"),s("button",{ref:t=>this.btnNext=t,onClick:()=>this.handleNext()},"skip_next")),s("div",{ref:t=>this.progressFull=t,onClick:t=>this.handleProgressSeek(t),class:"porgress"},s("div",{ref:t=>this.progressLoad=t,class:"load"}),s("div",{ref:t=>this.progressPlay=t,class:"play"})),s("div",{class:"timer"},s("span",{ref:t=>this.timerPlay=t},"0:00")," / ",s("span",{ref:t=>this.timerTotal=t},"0:00")),s("div",{class:"control-right"},s("button",{ref:t=>this.btnLoop=t,onClick:()=>this.handleLoopMode(),"data-once":"subdirectory_arrow_right","data-single":"repeat_one","data-list":"repeat","data-shuffle":"shuffle"},"cancel"),s("button",{ref:t=>this.btnLyric=t,onClick:()=>this.handleToggleDisplay()},"keyboard_capslock")))),t.appendChild(e),t.appendChild(this.hostElem)}constructor(){super(),this._singleMode=null,this._currentSecond=0,this._playing=null,this.audios=[],this._playIndex=null,this._lyricStatus=null,this.lyrics=null,this._lyricIndex=null,this._loopMode=null,this._displayVisible=null,this.hostElem=null,this.containerDisplay=null,this.lyricMaskLoading=null,this.lyricMaskFailed=null,this.lyricMaskNone=null,this.containerLyric=null,this.progressFull=null,this.progressPlay=null,this.progressLoad=null,this.timerPlay=null,this.timerTotal=null,this.btnPrev=null,this.btnPlay=null,this.btnNext=null,this.btnLoop=null,this.btnLyric=null,setTimeout(()=>{Array.from(this.children).filter(t=>t instanceof HTMLAudioElement).map(t=>this.registerAudio(t)),this.init();const t={detail:{audios:this.audios}};this.dispatchEvent(new CustomEvent("ready",t))},0),this.render()}connectedCallback(){c.log("connected.")}}window.customElements.get(c.TagName)||(window.customElements.define(c.TagName,c),document.head.appendChild(s("style",null,l.a.toString())))},function(t,e){t.exports="data:font/woff2;base64,d09GMgABAAAAAAPQAA8AAAAACigAAAN5AAEEWgAAAAAAAAAAAAAAAAAAAAAAAAAAGhwbEByCVAZgAIIACAQRCAqHCIQFATYCJANOC04ABCAFgnwHIBtUBwieg3GzHE1cIluZKjJ3mmh/34mH5+/Vc1/nxD1AG+u2hRsD1LGpNM1TkZ9qJmD4W2VLe3b3gB6EyPcCPJkQk0hKnQFHLsdmEWROnX2Gkqb3P4Do4IFjygNbg2URDmxiWRZtVYEQUUDj8Wg2sIHtftAD0M0bxf+ah3ess04m6R8gQD+AhCGRSJRkDIFeJheAAL1iZKGic/IwVALIFSCK+/Y4UEGAIAgQVBQegkuJKXcRIYmXLALnwQSSEIHxCmLxEEyMLEo0nYWJQJhAgTzCRJEwIYLIOiBWK/NyzGDEww2I4adficRUY8xhlyULE4KT6ALJhGAegfsuJ4F0Kk2wBBaTzot4V4GhdPYxxniawtp/W7hgcRSaEAqFRZa4i6VqBbPqliAigT5JEIe0G7ATX6Ml3E1IpDYAEMMAADybbv5mgAQQAGBGJmgHbWAB9IJ3HIEFnN9LmAHjPDhh2vlK0XLpcv1y83LrWtjGb78456TwuuXGz3S/2O3YzdjF2IXYv9FmxAEI0PUD7jl7wPm3PcAluAUJKkUNzwRUSjFMQqWOsh4wBZVG+mbADFRa8cxDPQzPAjR//9Jb5I0mQORKgCXAIdgCHyADQDeA6JgMYbiUsUYJvITgmqa4UCEKLoBB2aCfYY/BdJ0bbNwe2kEGTL4zED0ssodoh046VfbZExa7Fvp2MsVAzU3GnqE0X2ad1R4eZj6yatxi5jBZ8B1nDNtpO0Lf69yAcZoJ8Fj7tTPsebdmYO73Nxr7f30ZV1F3DB1130fvgKBSnB0XUrA9p0VUVhsaXp8+/TooQzZNZRgL/ymXGxYOH17A0FMmMjO8esJXvyv9xjGuPAE8zXg9fXOchStgXsDLUvDs6vqHzPIX+zuwAAAEiPaxZ/31q9PuqpZqMADlR9J+gH/l6CJA/EUGujFAQAIkoBAfEACASMAIsD6bV2cw29VH2AgsCccBCQQCBTkAuozhqF0DXABDkCgzCMblIoIbcr9SqAhJhMVnkWX4r9ERR51z3D577HVSnAJ58pWK0+qII/Y4aJcscdodtkOOOPUOOijOwLr4BL1slxN2Oe60XXbK0c1xMrHv4zhY5b/DEYedWJq0xykHOY5rScUno/24PXYdJMxxYJyKwgs5YnKBQtnyZV+iLeN7tCfs0x1x8uXcmLuU33vIPk+LA2b5UAAAAA=="},function(t,e){t.exports=function(t){return"string"==typeof t?(/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),/["'() \t\n]/.test(t)?'"'+t.replace(/"/g,'\\"').replace(/\n/g,"\\n")+'"':t):t}},function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,s=function(){function t(t,e){for(var i,n=0;n<e.length;n++)(i=e[n]).enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}return function(e,i,n){return i&&t(e.prototype,i),n&&t(e,n),e}}(),r=i(1),o=(n=r)&&n.__esModule?n:{default:n};var a=function(){function t(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:new o.default,i=!(1<arguments.length&&void 0!==arguments[1])||arguments[1];(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.offset=i,this._currentIndex=-1,this.setLrc(e)}return s(t,[{key:"setLrc",value:function(t){this.lrc=t.clone(),this.lrcUpdate()}},{key:"lrcUpdate",value:function(){this.offset&&this._offsetAlign(),this._sort()}},{key:"_offsetAlign",value:function(){if("offset"in this.lrc.info){var t=parseInt(this.lrc.info.offset)/1e3;isNaN(t)||(this.lrc.offset(t),delete this.lrc.info.offset)}}},{key:"_sort",value:function(){this.lrc.lyrics.sort(function(t,e){return t.timestamp-e.timestamp})}},{key:"timeUpdate",value:function(t){this._currentIndex>=this.lrc.lyrics.length?this._currentIndex=this.lrc.lyrics.length-1:-1>this._currentIndex&&(this._currentIndex=-1),this._currentIndex=this._findIndex(t,this._currentIndex)}},{key:"_findIndex",value:function(t,e){var i=Number.POSITIVE_INFINITY,n=-1==e?Number.NEGATIVE_INFINITY:this.lrc.lyrics[e].timestamp,s=e==this.lrc.lyrics.length-1?i:this.lrc.lyrics[e+1].timestamp;return t<n?this._findIndex(t,e-1):t===s?s===i?e:e+1:t>s?this._findIndex(t,e+1):e}},{key:"getInfo",value:function(){return this.lrc.info}},{key:"getLyrics",value:function(){return this.lrc.lyrics}},{key:"getLyric",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.curIndex();if(0<=t&&t<=this.lrc.lyrics.length-1)return this.lrc.lyrics[t];throw new Error("Index not exist")}},{key:"curIndex",value:function(){return this._currentIndex}},{key:"curLyric",value:function(){return this.getLyric()}}]),t}();e.default=a}]);
//# sourceMappingURL=player.min.js.map